---
description: コードの品質、セキュリティ、保守性をチェックする。コードを書いたり変更した直後に使用する。すべてのコード変更に必須。
---

# コードレビューコマンド

このコマンドは**code-reviewer**エージェントを呼び出して、コードの品質、セキュリティ、保守性をチェックします。

## このコマンドが行うこと

1. **コード品質チェック** - 可読性、一貫性、パフォーマンス
2. **セキュリティチェック** - 脆弱性、機密情報、入力検証
3. **保守性チェック** - コメント、関数分割、重複コード
4. **テストチェック** - カバレッジ、テスト品質

## 使用タイミング

`/code-review`を使用する場合：

- コードを書いた直後
- コードを変更した直後
- コミット前
- PR作成前

## チェック項目

### セキュリティ（重要）

- ハードコードされた認証情報（APIキー、パスワード、トークン）
- SQLインジェクションリスク（クエリ内の文字列連結）
- XSS脆弱性（エスケープされていないユーザー入力）
- 入力検証の欠如
- 安全でない依存関係（古い、脆弱な）
- パストラバーサルリスク（ユーザー制御のファイルパス）
- CSRF脆弱性
- 認証バイパス

### コード品質（高）

- 大きな関数（>50行）
- 大きなファイル（>800行）
- 深いネスト（>4レベル）
- エラーハンドリングの欠如（try/catch）
- console.logステートメント
- ミューテーションパターン
- 新規コードのテストの欠如

### パフォーマンス（中）

- 非効率なアルゴリズム（O(n²)が可能な場合のO(n log n)）
- Reactでの不要な再レンダリング
- メモ化の欠如
- 大きなバンドルサイズ
- 最適化されていない画像
- キャッシングの欠如
- N+1クエリ

### ベストプラクティス（中）

- コード/コメントでの絵文字の使用
- チケットなしのTODO/FIXME
- パブリックAPIのJSDocの欠如
- アクセシビリティの問題（ARIAラベルの欠如、コントラスト不良）
- 変数名が不適切（x、tmp、data）
- 説明なしのマジックナンバー
- 一貫性のないフォーマット

## レビュー出力形式

各問題について：

```text
[重要度] 問題の説明
ファイル: path/to/file.ts:行番号
説明: 詳細な説明
修正案: 具体的な修正方法
```

## 関連エージェント

このコマンドは`code-reviewer`エージェントを呼び出します：
`.cursor/agents/code-reviewer.md`
